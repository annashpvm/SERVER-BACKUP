<!--
/*!
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
-->
<html>
<head>
<title>GRID TEST Window</title>

<link rel="stylesheet" type="text/css" href="/ext-3.4.1/resources/css/ext-all.css" />
<script type="text/javascript" src="/ext-3.4.1/adapter/ext/ext-base.js"></script>
<script type="text/javascript" src="/ext-3.4.1/ext-all.js"></script>
    <link rel="stylesheet" type="text/css" href="/ext-3.4.1/examples/ux/css/GroupSummary.css" />
    <script type="text/javascript" src="/ext-3.4.1/examples/ux/GroupSummary.js"></script>


</head>

<!-- Revised from demo code in ext3.0.0 -->
<body>
<script type="text/javascript">
/*!
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.onReady(function(){

    Ext.QuickTips.init();

//    var xg = Ext.grid;




var GetModuleListDatastore = new Ext.data.GroupingStore({
      id: 'GetModuleListDatastore',
      autoLoad : true,
      proxy: new Ext.data.HttpProxy({
                url: 'Clsgridtest.php',      // File to connect to
                method: 'POST'
            }),
            baseParams:{task:"loadTBDetails"}, // this parameter asks for listing
      reader: new Ext.data.JsonReader({
                  // we tell the datastore where to get his data from
        root: 'results',
        totalProperty: 'total',
        id: 'id'
      },[    
      {name:'maingroupname' ,type:'string'},
      {name:'subgroupname'  ,type:'string'},
      {name:'subgrouplevel3',type:'string'},
      {name:'led_name'      ,type:'string'},   
      {name:'debit',type:'float'},
      {name:'credit',type:'float'},
      ]
      ),
//      sortInfo: {field: 'maingroupname', direction: 'ASC'},
      groupField: 'maingroupname',
      groupField2: 'subgroupname',
      groupDir  : "ASC",
      
//      groupField: 
 //     sortInfo: {field: 'subgroupname', direction: 'ASC'},
//            groupField: 'subgroupname',
});


    // define a custom summary function
    Ext.ux.grid.GroupSummary.Calculations['totalCost'] = function(v, record, field){
        return v + (record.data.debit );
    };

  // utilize custom extension for Group Summary
    var summary = new Ext.ux.grid.GroupSummary();

    var grid = new Ext.grid.EditorGridPanel({
        store:GetModuleListDatastore,
          
        columns: [    
            {header: "Main Group", dataIndex: 'maingroupname', sortable:true,width:200,align:'left', menuDisabled: true},       
            {header: "Sub Group", dataIndex: 'subgroupname', sortable:true,width:200,align:'left', menuDisabled: true},       
            {header: "Sub Group2", dataIndex: 'subgrouplevel3', sortable:true,width:250,align:'left', menuDisabled: true},       

            {header: "Ledger " ,  dataIndex: 'led_name', sortable:true,width:250,align:'left', menuDisabled: true,
                summaryType: 'count',
                summaryRenderer: function(v, params, data){
                    return ((v === 0 || v > 1) ? '(' + v +' Ledgers)' : '(1 Ledger)');
                },
},
            {header: "Debit " , dataIndex: 'debit', sortable:true,width:150,align:'right',summaryType: 'sum',renderer:function (value, record) {return Ext.util.Format.number(value, '00,00,00,00,000.00');}},
            {header: "Credit " ,  dataIndex: 'credit',sortable:true,width:150,align:'right',renderer:function (value, record) {return Ext.util.Format.number(value, '00,00,00,00,000.00');            
            },summaryType: 'sum',summaryRenderer:function (value, record){return Ext.util.Format.number(value, '00,00,00,000,0.00');
            }}],
            
        view: new Ext.grid.GroupingView({
            forceFit: true,
            showGroupName: false,
            enableNoGroups: false,
            enableGroupingMenu: false,
            hideGroupedColumn: true
        }),

        plugins: summary,

        tbar : [{
            text: 'Toggle',
            tooltip: 'Toggle the visibility of summary row',
            handler: function(){summary.toggleSummaries();}
        }],

        frame: true,
        width: 1200,
        height: 460,
        clicksToEdit: 1,
        collapsible: true,
        animCollapse: false,
        trackMouseOver: false,
        //enableColumnMove: false,
        title: 'GRID Details',
        iconCls: 'icon-grid',
        renderTo: document.body
    });


   function RefreshData()
   {

   }

   var UserMasPanel = new Ext.FormPanel({
    renderTo    : Ext.getBody(),
    xtype       : 'form',
    header      : true,
    width       : 800,
    height      : 50 ,bodyStyle:{"background-color":"#f7f7d7"},
    x           : 0,
    y           : 0,
    frame       : true,
    id          : 'UserMasPanel',
    method      : 'POST',
    layout      : 'absolute',
          tbar: { 
            xtype: 'toolbar',bodyStyle: "background: #d7d5fa;",
            height: 40,
            style   :'background-color:#d7d5fa',
            fontSize:50,
            items: [
        		
        	 {
                    text: 'Add',
                    style  : 'text-align:center;',
                    tooltip: 'Add Details...', height: 40, fontSize:70,width:70,
                  
                },'-',
           	 {
                    text: 'Edit',
                    style  : 'text-align:center;',
                    tooltip: 'Edit Details...', height: 40, fontSize:70,width:70,

                    listeners:{
                        click: function () {
                               edit_click();
                        }
                     }    

                  
                },'-',             
                  {
                    text: 'Save',
                    style  : 'text-align:center;',
                    tooltip: 'Save Details...', height: 40, fontSize:30,width:70,
                    icon: '/Pictures/save.png',

                    listeners:{
                        click: function () {

                        }
                    }
                },'-',                
        		
        	 {
                    text: 'Refresh',
                    style  : 'text-align:center;',
                    tooltip: 'Refresh Details...', height: 40, fontSize:70,width:70,
                    listeners:{
                        click: function () {
                               RefreshData();
                        }
                    }       
                },'-',
                
                 {
                    text: 'Exit',
                    style  : 'text-align:center;',
                    tooltip: 'Close...', height: 40, fontSize:70,width:70,
                         handler: function(){	
                            UsrMasWindow.hide();
                        }              
                }]
        },
                 items: [
            { 
            xtype   : 'fieldset',
                title   : '',
                layout  : 'hbox',
                border  : true,
                height  : 540,
                width   : 1280,
  
		style   : { border:'1px solid blue'},
                         style      : "border-radius:15px;",     
                layout  : 'absolute',
                x       : 10,
                y       : 10,	
                items:[
		    			{ 
						xtype       : 'fieldset',
						title       : '',
						labelWidth  : 1,
						width       : 1250,
						x           : 10,
						y           : 0,
					    	border      : false,
						items: [grid]
				          }, 

       ]
       
       }
       ]
       
 
});

 var UsrMasWindow = new Ext.Window({
	height      : 600,
        width       : 1300,
        y           : 10,
        title       :'GRID GROUP TESTING',
        items       : 'UserMasPanel',
        layout      : 'fit',
        closable    : true,bodyStyle:{"background-color":"#E9EEDD"},
        minimizable : true,
        maximizable : true,
        resizable   : false,
         border      : false,
        draggable   : false,

 	listeners:{
               show:function(){
               RefreshData();

             }
             }
            });
             
            UsrMasWindow.show();  
        }); 

// set up namespace for application


</script>

<div id="grid-example"></div>
</body>
</html>
